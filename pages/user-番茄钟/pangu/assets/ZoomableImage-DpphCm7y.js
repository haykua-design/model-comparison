import{r as n,j as e,p as Y,q as $,s as I,O as R,v as S,w as D,x as T,X as E}from"./vendor-B62vz6tA.js";import{c as k}from"./index-BvtcYo9n.js";function Z({src:g,alt:i,caption:h,className:C,thumbMaxHeightClassName:M="max-h-[320px]"}){const[s,b]=n.useState(1),[l,o]=n.useState({x:0,y:0}),[f,c]=n.useState(!1),r=n.useRef(null),j=n.useRef(null),w=1,y=4,p=n.useMemo(()=>`滚轮缩放（${w}x–${y}x），双击重置`,[]);return e.jsxs(Y,{onOpenChange:t=>{t&&(b(1),o({x:0,y:0}),c(!1),r.current=null)},children:[e.jsxs("div",{className:k("mt-4",C),children:[e.jsx($,{asChild:!0,children:e.jsxs("button",{type:"button",className:"group relative block w-full overflow-hidden rounded-xl border border-white/10 bg-white/5 text-left","aria-label":"点击放大查看图片",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/0 to-black/0"}),e.jsx("div",{className:"absolute bottom-3 left-3 rounded-lg bg-black/60 px-2 py-1 text-xs text-white",children:"点击放大"})]}),e.jsx("img",{src:g,alt:i,className:k("w-full object-contain",M),loading:"lazy"})]})}),h?e.jsx("div",{className:"mt-2 text-xs text-zinc-400",children:h}):null]}),e.jsxs(I,{children:[e.jsx(R,{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm"}),e.jsxs(S,{className:"fixed left-1/2 top-1/2 z-50 w-[min(96vw,1100px)] -translate-x-1/2 -translate-y-1/2 rounded-2xl border border-white/10 bg-zinc-950 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-white/10 px-4 py-3",children:[e.jsx(D,{className:"min-w-0 truncate text-sm font-medium text-white",children:h||i}),e.jsxs("div",{className:"hidden items-center gap-3 text-xs text-zinc-400 md:flex",children:[e.jsxs("span",{className:"rounded-md border border-white/10 bg-white/5 px-2 py-1 text-zinc-200 tabular-nums",children:[Math.round(s*100),"%"]}),e.jsx("span",{children:p})]}),e.jsx(T,{asChild:!0,children:e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-lg border border-white/10 bg-white/5 px-3 py-1.5 text-xs text-white hover:bg-white/10 transition","aria-label":"关闭",children:[e.jsx(E,{className:"h-4 w-4"}),"关闭"]})})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{ref:j,className:"relative flex max-h-[75dvh] w-full items-center justify-center overflow-hidden rounded-xl border border-white/10 bg-black/30",onWheel:t=>{t.preventDefault(),t.stopPropagation();const x=t.deltaY,d=.12;b(u=>{const m=x<0?u*(1+d):u/(1+d),a=Math.min(y,Math.max(w,Number(m.toFixed(3))));return a<=1.001&&o({x:0,y:0}),a})},onDoubleClick:()=>{b(1),o({x:0,y:0})},role:"img","aria-label":`${i}（${p}）`,title:p,children:e.jsx("img",{src:g,alt:i,className:"w-full object-contain",style:{maxHeight:"75dvh",transform:`translate(${l.x}px, ${l.y}px) scale(${s})`,transformOrigin:"center",transition:"transform 120ms ease-out",cursor:s>1?f?"grabbing":"grab":"zoom-in"},loading:"eager",draggable:!1,onPointerDown:t=>{if(!(s<=1.001)){c(!0),r.current={startX:t.clientX,startY:t.clientY,startOx:l.x,startOy:l.y};try{t.currentTarget.setPointerCapture(t.pointerId)}catch{}}},onPointerMove:t=>{if(!f||!r.current||s<=1.001)return;const x=j.current,d=t.clientX-r.current.startX,u=t.clientY-r.current.startY,m=x?.clientWidth??0,a=x?.clientHeight??0,v=m?m*(s-1)/2:1/0,N=a?a*(s-1)/2:1/0,O=r.current.startOx+d,z=r.current.startOy+u,P=Math.max(-v,Math.min(v,O)),X=Math.max(-N,Math.min(N,z));o({x:P,y:X})},onPointerUp:t=>{if(f){c(!1),r.current=null;try{t.currentTarget.releasePointerCapture(t.pointerId)}catch{}}},onPointerCancel:()=>{c(!1),r.current=null}})})})]})]})]})}export{Z};
