import{v as Y,w as $,r,j as e,x as I,y as R,P as S,O as D,z as T,E,G as H,X as W}from"./vendor-Cwq4KAb0.js";function M(...i){return Y($(i))}function F({src:i,alt:l,caption:b,className:k,thumbMaxHeightClassName:z="max-h-[320px]"}){const[n,f]=r.useState(1),[o,c]=r.useState({x:0,y:0}),[g,x]=r.useState(!1),s=r.useRef(null),w=r.useRef(null),y=1,j=4,p=r.useMemo(()=>`滚轮缩放（${y}x–${j}x），双击重置`,[]);return e.jsxs(I,{onOpenChange:t=>{t&&(f(1),c({x:0,y:0}),x(!1),s.current=null)},children:[e.jsxs("div",{className:M("mt-4",k),children:[e.jsx(R,{asChild:!0,children:e.jsxs("button",{type:"button",className:"group relative block w-full overflow-hidden rounded-xl border border-white/10 bg-white/5 text-left","aria-label":"点击放大查看图片",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/0 to-black/0"}),e.jsx("div",{className:"absolute bottom-3 left-3 rounded-lg bg-black/60 px-2 py-1 text-xs text-white",children:"点击放大"})]}),e.jsx("img",{src:i,alt:l,className:M("w-full object-contain",z),loading:"lazy"})]})}),b?e.jsx("div",{className:"mt-2 text-xs text-zinc-400",children:b}):null]}),e.jsxs(S,{children:[e.jsx(D,{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm"}),e.jsxs(T,{className:"fixed left-1/2 top-1/2 z-50 w-[min(96vw,1100px)] -translate-x-1/2 -translate-y-1/2 rounded-2xl border border-white/10 bg-zinc-950 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-white/10 px-4 py-3",children:[e.jsx(E,{className:"min-w-0 truncate text-sm font-medium text-white",children:b||l}),e.jsxs("div",{className:"hidden items-center gap-3 text-xs text-zinc-400 md:flex",children:[e.jsxs("span",{className:"rounded-md border border-white/10 bg-white/5 px-2 py-1 text-zinc-200 tabular-nums",children:[Math.round(n*100),"%"]}),e.jsx("span",{children:p})]}),e.jsx(H,{asChild:!0,children:e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-lg border border-white/10 bg-white/5 px-3 py-1.5 text-xs text-white hover:bg-white/10 transition","aria-label":"关闭",children:[e.jsx(W,{className:"h-4 w-4"}),"关闭"]})})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{ref:w,className:"relative flex max-h-[75dvh] w-full items-center justify-center overflow-hidden rounded-xl border border-white/10 bg-black/30",onWheel:t=>{t.preventDefault(),t.stopPropagation();const d=t.deltaY,u=.12;f(m=>{const h=d<0?m*(1+u):m/(1+u),a=Math.min(j,Math.max(y,Number(h.toFixed(3))));return a<=1.001&&c({x:0,y:0}),a})},onDoubleClick:()=>{f(1),c({x:0,y:0})},role:"img","aria-label":`${l}（${p}）`,title:p,children:e.jsx("img",{src:i,alt:l,className:"w-full object-contain",style:{maxHeight:"75dvh",transform:`translate(${o.x}px, ${o.y}px) scale(${n})`,transformOrigin:"center",transition:"transform 120ms ease-out",cursor:n>1?g?"grabbing":"grab":"zoom-in"},loading:"eager",draggable:!1,onPointerDown:t=>{if(!(n<=1.001)){x(!0),s.current={startX:t.clientX,startY:t.clientY,startOx:o.x,startOy:o.y};try{t.currentTarget.setPointerCapture(t.pointerId)}catch{}}},onPointerMove:t=>{if(!g||!s.current||n<=1.001)return;const d=w.current,u=t.clientX-s.current.startX,m=t.clientY-s.current.startY,h=d?.clientWidth??0,a=d?.clientHeight??0,v=h?h*(n-1)/2:1/0,N=a?a*(n-1)/2:1/0,C=s.current.startOx+u,O=s.current.startOy+m,P=Math.max(-v,Math.min(v,C)),X=Math.max(-N,Math.min(N,O));c({x:P,y:X})},onPointerUp:t=>{if(g){x(!1),s.current=null;try{t.currentTarget.releasePointerCapture(t.pointerId)}catch{}}},onPointerCancel:()=>{x(!1),s.current=null}})})})]})]})]})}export{F as Z,M as c};
